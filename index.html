<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotella Pizzaria - Seu Pedido</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Estilos personalizados para a fonte Inter e outros ajustes */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f8f8; /* Cor de fundo suave */
            color: #333;
            line-height: 1.6;
            /* Adiciona a imagem de fundo */
            background-image: url('https://i.ibb.co/tT199JXf/54361195-delicioso-caseiro-pizza-com-fresco-tomates-e-manjericao-gratis-foto.jpg');
            background-size: cover; /* Faz a imagem cobrir toda a área */
            background-position: center; /* Centraliza a imagem */
            background-attachment: fixed; /* Mantém a imagem fixa ao rolar */
        }
        /* Definição da fonte Inter */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

        /* Estilo para itens clicáveis */
        .clickable-item {
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .clickable-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        /* Estilo para sabores/bebidas desabilitados (aplicado SOMENTE na tela de escolha de sabores) */
        .disabled-option {
            opacity: 0.5;
            cursor: not-allowed;
        }
        /* Adiciona uma opacidade ao contêiner principal para o texto ficar legível sobre a imagem de fundo */
        .container {
            background-color: rgba(255, 255, 255, 0.9); /* Branco semi-transparente */
        }
        /* Estilo para o contêiner de sugestão da IA */
        .ai-suggestion-box {
            background-color: #ffeccf;
            border: 1px solid #ffcc80;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
            font-style: italic;
            color: #8a6d3b;
        }
        .ai-suggestion-box.loading {
            color: #555;
        }
    </style>
</head>
<body class="p-4 sm:p-6 lg:p-8 flex items-center justify-center min-h-screen">
    <div class="container mx-auto bg-white rounded-xl shadow-lg p-6 sm:p-8 lg:p-10 max-w-3xl border-t-4 border-red-600 relative">
        <div id="cart-icon-container" class="absolute top-4 right-4 cursor-pointer flex items-center justify-center bg-red-600 text-white rounded-full p-3 shadow-lg hover:bg-red-700 transition-colors z-10" onclick="showPage('order-summary')">
            <i class="fas fa-shopping-cart text-xl"></i>
            <span id="cart-count" class="ml-2 text-lg font-bold">0</span>
        </div>

        <div class="text-center mb-6 mt-4">
            <img src="https://i.ibb.co/YFhQZvBG/Whats-App-Image-2025-06-06-at-14-24-25.jpg" alt="Logo Rotella Pizzaria" class="mx-auto w-48 sm:w-64 h-auto rounded-lg shadow-md">
            <a href="https://www.instagram.com/rotellapizzaria" target="_blank" class="mt-4 inline-block text-red-600 hover:text-red-800 font-semibold text-lg">
                Nos siga no Instagram: @rotellapizzaria
            </a>
        </div>

        <div id="main-menu" class="page-section">
            <h2 class="text-2xl sm:text-3xl font-semibold text-gray-800 text-center mb-8">Nosso Cardápio Delicioso!</h2>

            <div class="mb-10">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6">Combos Especiais</h3>
                <p class="text-sm text-gray-600 mb-4 italic text-center">
                    *Obs: Válido somente para sabores tradicionais de pizza.
                </p>
                
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="combo" data-item-id="combo1" data-item-name="Combo 1" data-item-price="39.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Combo 1</p>
                        <p class="text-sm text-gray-600 mt-1">Pizza grande (até dois sabores) + Coca-cola de 1L</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 39,90</p>
                </div>

                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="combo" data-item-id="combo2" data-item-name="Combo 2" data-item-price="74.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Combo 2</p>
                        <p class="text-sm text-gray-600 mt-1">2 Pizzas grandes (até dois sabores cada) + Coca-cola de 2L</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 74,90</p>
                </div>
            </div>

            <div class="mb-10">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6">Pizzas</h3>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="pizza-tradicional" data-item-id="pizza-tradicional-grande" data-item-name="Pizza Grande Tradicional" data-item-price="34.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Pizza Grande Tradicional</p>
                        <p class="text-sm text-gray-600 mt-1">Até dois sabores</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 34,90</p>
                </div>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="pizza-especial" data-item-id="pizza-especial-grande" data-item-name="Pizza Grande Especial" data-item-price="44.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Pizza Grande Especial</p>
                        <p class="text-sm text-gray-600 mt-1">Até dois sabores</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 44,90</p>
                </div>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="pizza-media" data-item-id="pizza-media" data-item-name="Pizza Média Tradicional" data-item-price="29.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Pizza Média Tradicional</p>
                        <p class="text-sm text-gray-600 mt-1">Até dois sabores</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 29,90</p>
                </div>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="pizza-especial" data-item-id="pizza-especial-media" data-item-name="Pizza Média Especial" data-item-price="39.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Pizza Média Especial</p>
                        <p class="text-sm text-gray-600 mt-1">Até dois sabores</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 39,90</p>
                </div>
            </div>
            
            <div class="mb-10">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6">Esfirras</h3>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="esfirra-tradicional" data-item-id="esfirra-tradicional" data-item-name="Esfirra Salgada Tradicional" data-item-price="6.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Esfirra Salgada Tradicional</p>
                        <p class="text-sm text-gray-600 mt-1">Sabores tradicionais</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 6,90</p>
                </div>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="esfirra-especial" data-item-id="esfirra-especial" data-item-name="Esfirra Salgada Especial" data-item-price="7.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Esfirra Salgada Especial</p>
                        <p class="text-sm text-gray-600 mt-1">Todos os sabores</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 7,90</p>
                </div>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="esfirra-doce" data-item-id="esfirra-doce" data-item-name="Esfirra Doce" data-item-price="7.90"> <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Esfirra Doce</p>
                        <p class="text-sm text-gray-600 mt-1">Brigadeiro e Romeu e Julieta</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 7,90</p>
                </div>
            </div>
            
            <div class="text-center mt-10 mb-6">
                <button onclick="window.open('https://wa.me/92986161640?text=Ol%C3%A1%2C%20gostaria%20de%20fazer%20um%20pedido!', '_blank')" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50">
                    <i class="fab fa-whatsapp mr-2"></i> Falar com um atendente
                </button>
            </div>
            
        </div>

        <div id="flavor-selection" class="page-section hidden">
            <h2 class="text-2xl sm:text-3xl font-semibold text-gray-800 text-center mb-8">Personalize seu Pedido</h2>

            <div id="item-info" class="text-center text-lg text-gray-700 mb-6 p-4 bg-red-50 rounded-lg">
                </div>

            <div id="crust-options-section" class="mb-10 hidden">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6">Borda Recheada</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8">
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="stuffed-crust" value="Sem Borda Recheada" data-crust-price="0.00" data-crust-id="no-crust" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500" checked>
                        <span class="ml-3 text-lg text-gray-800 font-medium">Sem Borda Recheada</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="stuffed-crust" value="Borda Recheada Catupiry" data-crust-price="10.00" data-crust-id="catupiry-crust" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Borda Recheada Catupiry +R$10,00</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="stuffed-crust" value="Borda Recheada Chocolate" data-crust-price="10.00" data-crust-id="chocolate-crust" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Borda Recheada Chocolate +R$10,00</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="stuffed-crust" value="Borda Recheada Romeu e Julieta" data-crust-price="10.00" data-crust-id="rj-crust" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Borda Recheada Romeu e Julieta +R$10,00</span>
                    </label>
                </div>
            </div>

            <div class="mb-10">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6">Selecione seus Sabores</h3>
                <p id="flavor-instruction-text" class="text-md text-gray-600 text-center mb-6">
                    </p>

                <div id="flavor-options" class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8">
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Portuguesa" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Portuguesa</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Calabresa" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Calabresa</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Mussarela" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Mussarela</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Marguerita" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Marguerita</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Frango com Catupiry" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Frango com Catupiry</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Calabresa com Catupiry" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Calabresa com Catupiry</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Brigadeiro" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Brigadeiro</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Romeu e Julieta" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Romeu e Julieta</span>
                    </label>
                </div>
            </div>

            <div class="mb-10">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6" id="beverage-heading"></h3> <div id="beverage-options" class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8">
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="beverage" value="Coca-cola 1L" data-beverage-price="9.90" data-beverage-id="coca-1l" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Coca-cola 1L - R$ 9,90</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="beverage" value="Coca-cola 2L" data-beverage-price="13.90" data-beverage-id="coca-2l" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Coca-cola 2L - R$ 13,90</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="beverage" value="Fanta Laranja 2L" data-beverage-price="12.90" data-beverage-id="fanta-2l" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Fanta Laranja 2L - R$ 12,90</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="beverage" value="Nenhuma bebida" data-beverage-price="0.00" data-beverage-id="no-beverage" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500" checked>
                        <span class="ml-3 text-lg text-gray-800 font-medium">Nenhuma bebida</span>
                    </label>
                </div>
            </div>

            <div class="text-center space-x-4">
                <button id="add-to-cart-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50" disabled>
                    Adicionar ao Carrinho
                </button>
                <button onclick="showPage('main-menu')" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50">
                    Voltar ao Cardápio
                </button>
            </div>
        </div>

        <div id="order-summary" class="page-section hidden">
            <h2 class="text-2xl sm:text-3xl font-semibold text-gray-800 text-center mb-8">Seu Carrinho</h2>

            <div id="cart-items-container" class="bg-gray-50 p-6 rounded-lg shadow-inner mb-8">
                <p id="empty-cart-message" class="text-center text-gray-600 italic hidden">Seu carrinho está vazio.</p>
            </div>

            <div class="mb-6 p-4 border rounded-lg bg-white shadow-sm">
                <h3 class="text-xl font-bold text-gray-800 mb-3">Endereço de Entrega</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label for="address-street" class="block text-sm font-medium text-gray-700">Rua</label>
                        <input type="text" id="address-street" placeholder="Ex: Av. Brasil" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                    <div>
                        <label for="address-number" class="block text-sm font-medium text-gray-700">Número</label>
                        <input type="text" id="address-number" placeholder="Ex: 123" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                    <div>
                        <label for="address-neighborhood" class="block text-sm font-medium text-gray-700">Bairro</label>
                        <input type="text" id="address-neighborhood" placeholder="Ex: Centro" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                    <div class="sm:col-span-2">
                        <label for="address-reference" class="block text-sm font-medium text-gray-700">Ponto de Referência (Opcional)</label>
                        <input type="text" id="address-reference" placeholder="Ex: Próximo à praça" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                </div>
            </div>

            <div class="mb-6 p-4 border rounded-lg bg-white shadow-sm">
                <h3 class="text-xl font-bold text-gray-800 mb-3">Forma de pagamento</h3>
                <div class="grid grid-cols-1 sm:grid-cols-4 gap-4">
                    <label class="flex items-center p-3 border rounded-lg shadow-sm cursor-pointer bg-white">
                        <input type="radio" name="payment-method" value="Pix" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500" checked>
                        <span class="ml-3 text-lg text-gray-800 font-medium">Pix</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm cursor-pointer bg-white">
                        <input type="radio" name="payment-method" value="Crédito" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Crédito</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm cursor-pointer bg-white">
                        <input type="radio" name="payment-method" value="Débito" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Débito</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm cursor-pointer bg-white">
                        <input type="radio" name="payment-method" value="Dinheiro" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Dinheiro</span>
                    </label>
                </div>
            </div>


            <div class="text-right text-3xl font-extrabold text-red-700 mt-6 pt-4 border-t-2 border-red-300 mb-8">
                <span class="font-semibold">Total do Pedido:</span> <span id="cart-total-price">R$ 0,00</span>
            </div>

            <div class="text-center space-x-4">
                <button id="place-order-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50" disabled>
                    Enviar Pedido
                </button>
                <button onclick="showPage('main-menu')" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50">
                    Voltar ao Cardápio
                </button>
            </div>
        </div>
        
        <p class="text-center text-gray-500 text-sm mt-10">Obrigado por escolher Rotella Pizzaria! Bom apetite!</p>
    </div>

    <script>
        // Array para armazenar os itens no carrinho (pizza/combo e bebidas separadas)
        let cart = []; 
        let selectedItem = {}; // Item (pizza/combo) sendo configurado na tela de seleção de sabores
        let selectedBeverage = { name: 'Nenhuma bebida', price: 0, id: 'no-beverage' }; // Bebida selecionada na tela de seleção
        let selectedCrust = { name: 'Sem Borda Recheada', price: 0, id: 'no-crust' }; // Borda selecionada
        let deliveryFee = 0; // Armazena a taxa de entrega calculada, agora sempre 0

        // const ORIGIN_ZIP_CODE = '69095510'; // CEP de origem fixo - Comentado
        // const Maps_API_KEY = 'AIzaSyBd6-d4xDeEdHCILpv_c5xqGTBAR8o8xm4'; // Sua chave de API - Comentado

        // Função para mostrar a página correta e esconder as outras
        function showPage(pageId) {
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(pageId).classList.remove('hidden');

            // Se for para a página de resumo, atualiza o carrinho
            if (pageId === 'order-summary') {
                renderCart();
            }
        }

        // Função para atualizar a contagem de itens no ícone do carrinho
        function updateCartIconCount() {
            let totalItemsInCart = 0;
            cart.forEach(item => {
                totalItemsInCart += item.quantity;
            });
            document.getElementById('cart-count').textContent = totalItemsInCart;
        }

        // === Lógica do Cardápio Principal ===
        document.querySelectorAll('.clickable-item').forEach(item => {
            item.addEventListener('click', function() {
                selectedItem = {
                    type: this.dataset.itemType, // 'combo', 'pizza-tradicional', 'pizza-especial', 'pizza-media', 'esfirra-tradicional', 'esfirra-especial', 'esfirra-doce'
                    id: this.dataset.itemId,
                    name: this.dataset.itemName,
                    price: parseFloat(this.dataset.itemPrice)
                };
                
                // Reinicia os checkboxes de sabor e o botão ao ir para seleção de sabores
                document.querySelectorAll('input[name="flavor"]').forEach(cb => {
                    cb.checked = false;
                    cb.disabled = false;
                    cb.closest('label').classList.remove('disabled-option'); // Remove o estilo de desabilitado
                });
                
                // Reinicia a seleção de bebida para "Nenhuma bebida"
                selectedBeverage = { name: 'Nenhuma bebida', price: 0, id: 'no-beverage' };
                document.querySelectorAll('input[name="beverage"]').forEach(radio => {
                    radio.checked = (radio.value === 'Nenhuma bebida'); // Marca a opção "Nenhuma bebida"
                });

                // Reinicia a seleção de borda para "Sem Borda Recheada"
                selectedCrust = { name: 'Sem Borda Recheada', price: 0, id: 'no-crust' };
                document.querySelectorAll('input[name="stuffed-crust"]').forEach(radio => {
                    radio.checked = (radio.value === 'Sem Borda Recheada');
                });


                // Atualiza o texto de instrução da seleção de sabores e o estado do botão
                updateFlavorSelectionInstructions();
                updateFinalizeButtonState(); 
                
                // Atualiza as informações do item na página de seleção de sabores
                document.getElementById('item-info').innerHTML = `Você selecionou: <span class="font-bold">${selectedItem.name}</span> por <span class="font-bold">R$ ${selectedItem.price.toFixed(2).replace('.', ',')}</span>`;
                
                // Redireciona para a seleção de sabor para itens que exigem sabor
                if (selectedItem.id.includes('pizza') || selectedItem.id.includes('combo') || selectedItem.id.includes('esfirra')) {
                    showPage('flavor-selection');
                } else {
                    // Para outros itens que não precisam de seleção de sabor (se houver no futuro)
                    // Adiciona o item diretamente ao carrinho se não precisar de seleção de sabor
                    cart.push({
                        name: selectedItem.name,
                        price: selectedItem.price,
                        quantity: 1,
                        flavors: [],
                        type: selectedItem.type,
                        id: selectedItem.id 
                    });
                    renderCart(); // Renderiza o carrinho e atualiza o ícone (chamado aqui para itens sem seleção)
                    showPage('order-summary');
                }
            });
        });

        // === Lógica da Seleção de Sabores e Bebidas ===
        const flavorCheckboxes = document.querySelectorAll('input[name="flavor"]');
        const beverageRadios = document.querySelectorAll('input[name="beverage"]');
        const stuffedCrustRadios = document.querySelectorAll('input[name="stuffed-crust"]'); // Referência às bordas
        const crustOptionsSection = document.getElementById('crust-options-section'); // Referência à seção de bordas

        const addToCartBtn = document.getElementById('add-to-cart-btn'); // Botão "Adicionar ao Carrinho"
        const flavorInstructionText = document.getElementById('flavor-instruction-text');
        const beverageHeading = document.getElementById('beverage-heading'); // Referência ao cabeçalho das bebidas


        const traditionalFlavors = ['Portuguesa', 'Calabresa', 'Mussarela', 'Marguerita'];
        const sweetFlavors = ['Brigadeiro', 'Romeu e Julieta']; // Sabores doces específicos


        // Função para atualizar as instruções de seleção de sabor e habilitar/desabilitar checkboxes
        function updateFlavorSelectionInstructions() {
            // Re-habilita todos os checkboxes inicialmente antes de aplicar novas restrições
            flavorCheckboxes.forEach(cb => {
                cb.checked = false; // Garante que nenhum sabor esteja pré-selecionado
                cb.disabled = false;
                cb.closest('label').classList.remove('disabled-option');
                cb.closest('label').style.display = 'flex'; // Garante que estejam visíveis antes de filtrar
            });

            // Ajusta o texto do cabeçalho da bebida
            if (selectedItem.type === 'combo') {
                beverageHeading.textContent = 'Seu combo já possui refrigerante, deseja acrescentar mais alguma bebida?'; // Texto ajustado para combos
            } else {
                beverageHeading.textContent = 'Deseja acrescentar refrigerante ao seu pedido ?'; // Texto padrão para outros itens
            }

            // Lógica de exibição e habilitação das bordas recheadas
            if (selectedItem.id === 'pizza-tradicional-grande' || selectedItem.id === 'pizza-especial-grande') {
                crustOptionsSection.style.display = 'block'; // Mostra a seção de bordas
                stuffedCrustRadios.forEach(radio => {
                    radio.disabled = false;
                    radio.closest('label').classList.remove('disabled-option');
                    radio.closest('label').style.display = 'flex'; // Garante que as bordas estejam visíveis
                });
            } else {
                crustOptionsSection.style.display = 'none'; // Esconde a seção de bordas
                stuffedCrustRadios.forEach(radio => { // Desabilita e desmarca as bordas se a seção estiver escondida
                    radio.checked = false;
                    radio.disabled = true;
                    if (radio.dataset.crustId === 'no-crust') { // Garante que "Sem Borda Recheada" esteja marcada por padrão, mesmo escondida
                        radio.checked = true;
                        selectedCrust = { name: 'Sem Borda Recheada', price: 0, id: 'no-crust' };
                    }
                });
            }


            if (selectedItem.id === 'combo2') {
                flavorInstructionText.textContent = 'Para o Combo 2 (2 pizzas grandes), escolha 1 sabor para ambas as pizzas, ou até 4 sabores para pizzas diferentes.';
                // Para combos, apenas sabores tradicionais são permitidos
                flavorCheckboxes.forEach(cb => {
                    if (!traditionalFlavors.includes(cb.value)) {
                        cb.disabled = true;
                        cb.closest('label').classList.add('disabled-option');
                        cb.closest('label').style.display = 'none'; // Esconde sabores não tradicionais
                    }
                });
            } else if (selectedItem.id === 'esfirra-doce') { 
                flavorInstructionText.textContent = 'Escolha apenas 1 sabor para sua esfirra doce (Brigadeiro ou Romeu e Julieta).';
                 flavorCheckboxes.forEach(cb => {
                    if (!sweetFlavors.includes(cb.value)) { // Desabilita se não for sabor doce
                        cb.disabled = true;
                        cb.closest('label').classList.add('disabled-option');
                        cb.closest('label').style.display = 'none'; // Esconde sabores não doces
                    }
                });
            }
            else if (selectedItem.id === 'combo1' || selectedItem.id === 'pizza-tradicional-grande' || selectedItem.id === 'pizza-media') { 
                // AQUI FOI FEITO O AJUSTE PARA A "PIZZA GRANDE TRADICIONAL" PARA ATÉ 2 SABORES
                flavorInstructionText.textContent = `Escolha até 2 sabores para sua pizza. Se selecionar apenas 1, a pizza será inteira desse sabor.`;
                
                // Para Combo 1, Pizzas Tradicionais e Pizza Média, apenas sabores tradicionais são permitidos
                flavorCheckboxes.forEach(cb => {
                    if (!traditionalFlavors.includes(cb.value)) {
                        cb.disabled = true;
                        cb.closest('label').classList.add('disabled-option');
                        cb.closest('label').style.display = 'none'; // Esconde sabores não tradicionais
                    }
                });
            } else if (selectedItem.id === 'esfirra-tradicional') { 
                flavorInstructionText.textContent = 'Escolha apenas 1 sabor para sua esfirra tradicional.';
                // Para Esfirra Tradicional, apenas sabores tradicionais são permitidos
                flavorCheckboxes.forEach(cb => {
                    if (!traditionalFlavors.includes(cb.value)) {
                        cb.disabled = true;
                        cb.closest('label').classList.add('disabled-option');
                        cb.closest('label').style.display = 'none'; // Esconde sabores não tradicionais
                    }
                });
            }
            else if (selectedItem.id === 'pizza-especial-grande' || selectedItem.id === 'pizza-especial-media' || selectedItem.id === 'esfirra-especial') { 
                if (selectedItem.id === 'pizza-especial-grande' || selectedItem.id === 'pizza-especial-media') {
                    flavorInstructionText.textContent = `Para sua ${selectedItem.name}, escolha até 2 sabores para sua pizza. Se selecionar apenas 1, a pizza será inteira desse sabor.`;
                } else { // Para esfirra-especial
                    flavorInstructionText.textContent = `Para sua ${selectedItem.name}, escolha apenas 1 sabor.`;
                }
                
                // Para esfirra especial e pizzas especiais, todos os sabores salgados são permitidos
                flavorCheckboxes.forEach(cb => {
                    if (sweetFlavors.includes(cb.value)) { // Desabilita e esconde se for sabor doce
                        cb.disabled = true;
                        cb.closest('label').classList.add('disabled-option');
                        cb.closest('label').style.display = 'none'; // Esconde sabores doces
                    }
                });
            } else {
                flavorInstructionText.textContent = 'Escolha seus sabores.'; // Genérico para outros itens
            }
        }

        // Adiciona listener para cada checkbox de sabor
        flavorCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                const checkedCount = document.querySelectorAll('input[name="flavor"]:checked').length;
                let maxAllowedFlavors;

                if (selectedItem.id === 'combo2') {
                    maxAllowedFlavors = 4;
                } else if (selectedItem.id.includes('esfirra')) { // Esfirra Salgada (ambas) e Doce permite apenas 1 sabor
                    maxAllowedFlavors = 1;
                }
                else if (selectedItem.id.includes('pizza')) { // Isso inclui todas as pizzas individuais e Combo1
                    maxAllowedFlavors = 2; 
                } else {
                    maxAllowedFlavors = 2; // Padrão (fallback)
                }

                if (checkedCount >= maxAllowedFlavors) {
                    flavorCheckboxes.forEach(cb => {
                        // Só desabilita se não estiver checado E se não for um sabor já desabilitado pela categoria (ex: não tradicional ou não doce para esfirra doce)
                        if (!cb.checked && !cb.disabled) { 
                            cb.disabled = true;
                        }
                    });
                } else {
                    // Re-habilita os checkboxes que não foram desabilitados por restrição de categoria de pizza
                    flavorCheckboxes.forEach(cb => {
                        if (!cb.checked) { // Se não estiver checado
                            if (selectedItem.id === 'combo2' || selectedItem.id === 'combo1' || selectedItem.id === 'pizza-tradicional-grande' || selectedItem.id === 'pizza-media' || selectedItem.id === 'esfirra-tradicional') { 
                                // Regra para itens tradicionais: só re-habilita tradicionais
                                if (traditionalFlavors.includes(cb.value)) {
                                    cb.disabled = false;
                                }
                            } else if (selectedItem.id === 'esfirra-doce') { // Regra para esfirra doce: só re-habilita doces
                                if (sweetFlavors.includes(cb.value)) {
                                    cb.disabled = false;
                                }
                            }
                            else if (selectedItem.id === 'esfirra-especial' || selectedItem.id === 'pizza-especial-grande' || selectedItem.id === 'pizza-especial-media') {
                                // Regra para esfirra especial e pizzas especiais: re-habilita tudo que não for doce
                                if (!sweetFlavors.includes(cb.value)) {
                                     cb.disabled = false;
                                }
                            }
                            else { // Para outros tipos (fallback), habilita todos
                                cb.disabled = false;
                            }
                        }
                    });
                }
                updateFinalizeButtonState();
            });
        });

        // Adiciona listener para cada radio button de bebida
        beverageRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                selectedBeverage = {
                    name: radio.value,
                    price: parseFloat(radio.dataset.beveragePrice),
                    id: radio.dataset.beverageId // Adiciona o ID da bebida
                };
                updateFinalizeButtonState(); 
            });
        });

        // Adiciona listener para cada radio button de borda recheada
        stuffedCrustRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                selectedCrust = {
                    name: radio.value,
                    price: parseFloat(radio.dataset.crustPrice),
                    id: radio.dataset.crustId
                };
                // A seleção da borda não altera a habilitação do botão "Adicionar ao Carrinho"
                // pois o botão já depende da seleção de sabores.
            });
        });


        // Função para atualizar o estado do botão "Adicionar ao Carrinho"
        function updateFinalizeButtonState() {
            const checkedFlavorsCount = document.querySelectorAll('input[name="flavor"]:checked').length;
            let minFlavorsToEnableButton;

            // Determina o número mínimo de sabores para habilitar o botão
            if (selectedItem.id === 'combo2') {
                minFlavorsToEnableButton = 1; 
            } else if (selectedItem.id.includes('esfirra')) { // Esfirras (ambas) exigem apenas 1 sabor
                minFlavorsToEnableButton = 1;
            }
            else if (selectedItem.id.includes('pizza') || selectedItem.type === 'combo') { // Inclui todos os tipos de pizza e o Combo1
                minFlavorsToEnableButton = 1; 
            } else {
                minFlavorsToEnableButton = 0; 
            }

            // O botão "Adicionar ao Carrinho" é habilitado se a condição de sabores for atendida
            const isFlavorConditionMet = checkedFlavorsCount >= minFlavorsToEnableButton;
            addToCartBtn.disabled = !isFlavorConditionMet; // Usa addToCartBtn
        }

        // Evento de clique para o botão "Adicionar ao Carrinho"
        addToCartBtn.addEventListener('click', () => { // Usa addToCartBtn
            const selectedFlavors = Array.from(document.querySelectorAll('input[name="flavor"]:checked'))
                                       .map(cb => cb.value);
            
            // Adiciona a pizza/combo/esfirra ao carrinho
            cart.push({
                name: selectedItem.name,
                price: selectedItem.price + selectedCrust.price, // PREÇO AJUSTADO COM A BORDA
                quantity: 1, 
                flavors: selectedFlavors,
                type: selectedItem.type,
                id: selectedItem.id,
                crust: selectedCrust.name !== 'Sem Borda Recheada' ? selectedCrust : null // Armazena a borda selecionada
            });

            // Se uma bebida foi selecionada (e não é "Nenhuma bebida"), adicione-a como um item separado
            if (selectedBeverage.name !== 'Nenhuma bebida') {
                cart.push({
                    name: selectedBeverage.name,
                    price: selectedBeverage.price,
                    quantity: 1, // Bebida é adicionada como 1 unidade por padrão
                    type: 'beverage', // Novo tipo para bebidas
                    id: selectedBeverage.id 
                });
            }

            updateCartIconCount(); // Atualiza a contagem no ícone do carrinho
            showPage('order-summary'); // Vai para a tela de resumo/carrinho
        });

        // === Lógica do Carrinho de Compras / Resumo ===
        const cartItemsContainer = document.getElementById('cart-items-container');
        const cartTotalPriceElement = document.getElementById('cart-total-price');
        const placeOrderBtn = document.getElementById('place-order-btn');
        const emptyCartMessage = document.getElementById('empty-cart-message');

        // Referências aos campos de endereço
        const addressStreetInput = document.getElementById('address-street');
        const addressNumberInput = document.getElementById('address-number');
        const addressNeighborhoodInput = document.getElementById('address-neighborhood');
        const addressReferenceInput = document.getElementById('address-reference');

        // Variável para armazenar a opção de pagamento selecionada
        let selectedPaymentMethod = 'Pix'; // Pix como padrão

        // Listener para os radio buttons de pagamento
        document.querySelectorAll('input[name="payment-method"]').forEach(radio => {
            radio.addEventListener('change', () => {
                selectedPaymentMethod = radio.value;
            });
        });


        function renderCart() {
            cartItemsContainer.innerHTML = ''; // Limpa o conteúdo atual do carrinho
            
            if (cart.length === 0) {
                emptyCartMessage.classList.remove('hidden');
                placeOrderBtn.disabled = true;
            } else {
                emptyCartMessage.classList.add('hidden');
                placeOrderBtn.disabled = false;

                cart.forEach((item, index) => {
                    let itemDisplayPrice = item.price; // Preço unitário para exibição
                    let itemDescription = '';

                    if (item.type === 'beverage') {
                        itemDescription = `Bebida: ${item.name}`;
                    } else { // É uma pizza ou combo ou esfirra
                        // Monta o texto dos sabores
                        let flavorsText = '';
                        if (item.flavors && item.flavors.length > 0) {
                            // Ajustado para esfirras: se for esfirra e apenas 1 sabor, mostrar como inteira
                            if (item.flavors.length === 1 && item.id.includes('esfirra')) {
                                flavorsText = ` (${item.flavors[0]} inteira)`;
                            } else if (item.flavors.length === 1) { // Pizzas com 1 sabor
                                flavorsText = ` (${item.flavors[0]} inteira)`;
                            }
                             else if (item.flavors.length === 2 && (item.id.includes('pizza') || item.id === 'combo1' || item.id.includes('esfirra-tradicional'))) {
                                flavorsText = ` (${item.flavors[0]} e ${item.flavors[1]})`;
                            } else if (item.flavors.length >= 2 && item.id === 'combo2') { 
                                flavorsText = item.flavors.slice(0, -1).join(', ') + ' e ' + item.flavors[item.flavors.length - 1];
                            }
                        } else {
                            flavorsText = 'N/A';
                        }
                        itemDescription = `Sabores: ${flavorsText}`;

                        // Adiciona a borda recheada à descrição
                        if (item.crust && item.crust.name !== 'Sem Borda Recheada') {
                            itemDescription += `<br>Borda: ${item.crust.name}`;
                        }
                    }
                    
                    const cartItemHtml = `
                        <div class="flex items-center justify-between py-3 border-b border-gray-200 last:border-b-0">
                            <div class="flex-grow">
                                <p class="text-lg font-bold text-gray-900">${item.name}</p>
                                <p class="text-sm text-gray-600">${itemDescription}</p>
                                <p class="text-sm text-gray-700 font-semibold">R$ ${itemDisplayPrice.toFixed(2).replace('.', ',')} /un</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <button onclick="updateQuantity(${index}, -1)" class="bg-red-500 hover:bg-red-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-lg">-</button>
                                <span class="text-xl font-bold">${item.quantity}</span>
                                <button onclick="updateQuantity(${index}, 1)" class="bg-green-500 hover:bg-green-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-lg">+</button>
                            </div>
                        </div>
                    `;
                    cartItemsContainer.innerHTML += cartItemHtml;
                });
                updateCartIconCount(); // Atualiza a contagem no ícone do carrinho
            }
            calculateTotalCartPrice(); // Recalcula o total (agora sem taxa de entrega)
        }

        // Função para atualizar a quantidade de um item no carrinho
        function updateQuantity(index, change) {
            if (cart[index]) {
                cart[index].quantity += change;
                if (cart[index].quantity <= 0) {
                    cart.splice(index, 1); // Remove o item se a quantidade for 0 ou menos
                }
            }
            renderCart(); // Re-renderiza o carrinho para refletir as mudanças
        }

        // Funções relacionadas ao cálculo de entrega foram comentadas/removidas
        /*
        function calculateDeliveryFee(distance) { ... }
        const ORIGIN_ZIP_CODE = '69095510';
        const Maps_API_KEY = 'AIzaSyBd6-d4xDeEdHCILpv_c5xqGTBAR8o8xm4';
        async function getDistanceViaGoogleMapsAPI(originZip, destinationZip) { ... }
        function getSimulatedDistance(destinationZip) { ... }
        */

        // Função para calcular e exibir o total do carrinho, SEM a taxa de entrega
        function calculateTotalCartPrice() {
            let subtotal = 0;
            cart.forEach(item => {
                subtotal += item.price * item.quantity;
            });

            // deliveryFee agora é sempre 0, então basta somar o subtotal
            let total = subtotal; // Não soma deliveryFee
            cartTotalPriceElement.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
        }

        // O evento para o botão "Calcular Taxa" foi removido
        // calculateDeliveryBtn.addEventListener('click', async () => { ... });

        // Evento para o botão "Enviar Pedido"
        placeOrderBtn.addEventListener('click', () => {
            const whatsappNumber = '92986161640';
            const message = prepareWhatsAppMessage();
            const whatsappLink = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappLink, '_blank'); // Abre o link no WhatsApp em uma nova aba
        });

        // Função para preparar a mensagem do WhatsApp
        function prepareWhatsAppMessage() {
            let message = 'Olá! Gostaria de fazer um pedido na Rotella Pizzaria:\n\n*Itens do Pedido:*\n';

            cart.forEach(item => {
                let itemDetails = `- ${item.quantity}x ${item.name}`;
                if (item.type !== 'beverage') { // Se for pizza/combo, adiciona sabores e borda
                    let flavorsText = '';
                    if (item.flavors && item.flavors.length > 0) {
                        if (item.id.includes('esfirra') && item.flavors.length === 1) { 
                            flavorsText = ` (${item.flavors[0]} inteira)`;
                        } else if (item.flavors.length === 1) { 
                            flavorsText = ` (${item.flavors[0]} inteira)`;
                        } else if (item.flavors.length === 2) { 
                            flavorsText = ` (${item.flavors[0]} e ${item.flavors[1]})`;
                        } else { 
                            flavorsText = ` (${item.flavors.join(', ')})`;
                        }
                    }
                    let crustText = '';
                    if (item.crust && item.crust.name !== 'Sem Borda Recheada') {
                        crustText = ` (Borda: ${item.crust.name})`;
                    }
                    itemDetails += flavorsText + crustText;
                }
                message += itemDetails + ` - R$ ${item.price.toFixed(2).replace('.', ',')}\n`;
            });

            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            message += `\n*Total do Pedido:* R$ ${subtotal.toFixed(2).replace('.', ',')}\n\n`; // Apenas o subtotal
            
            message += `*Endereço de Entrega:*\n`;
            message += `Rua: ${addressStreetInput.value || 'Não informado'}\n`;
            message += `Número: ${addressNumberInput.value || 'Não informado'}\n`;
            message += `Bairro: ${addressNeighborhoodInput.value || 'Não informado'}\n`;
            if (addressReferenceInput.value) {
                message += `Ponto de Referência: ${addressReferenceInput.value}\n`;
            } else {
                message += `Ponto de Referência: Não informado\n`;
            }
            
            message += `\n*Forma de Pagamento:* ${selectedPaymentMethod}\n\n`;
            message += 'Aguardamos a confirmação!';

            return message;
        }


        // Inicializa mostrando a página do cardápio principal e atualiza o ícone do carrinho
        document.addEventListener('DOMContentLoaded', () => {
            showPage('main-menu');
            updateCartIconCount(); // Garante que a contagem do carrinho seja exibida corretamente ao carregar
        });
    </script>
</body>
</html>
