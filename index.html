<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotella Pizzaria - Seu Pedido</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Estilos personalizados para a fonte Inter e outros ajustes */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f8f8; /* Cor de fundo suave */
            color: #333;
            line-height: 1.6;
            /* Adiciona a imagem de fundo */
            background-image: url('https://i.ibb.co/tT199JXf/54361195-delicioso-caseiro-pizza-com-fresco-tomates-e-manjericao-gratis-foto.jpg');
            background-size: cover; /* Faz a imagem cobrir toda a área */
            background-position: center; /* Centraliza a imagem */
            background-attachment: fixed; /* Mantém a imagem fixa ao rolar */
        }
        /* Definição da fonte Inter */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

        /* Estilo para itens clicáveis */
        .clickable-item {
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .clickable-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        /* Estilo para sabores/bebidas desabilitados (aplicado SOMENTE na tela de escolha de sabores) */
        .disabled-option {
            opacity: 0.5;
            cursor: not-allowed;
        }
        /* Adiciona uma opacidade ao contêiner principal para o texto ficar legível sobre a imagem de fundo */
        .container {
            background-color: rgba(255, 255, 255, 0.9); /* Branco semi-transparente */
        }
        /* Estilo para o contêiner de sugestão da IA */
        .ai-suggestion-box {
            background-color: #ffeccf;
            border: 1px solid #ffcc80;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
            font-style: italic;
            color: #8a6d3b;
        }
        .ai-suggestion-box.loading {
            color: #555;
        }
    </style>
</head>
<body class="p-4 sm:p-6 lg:p-8 flex items-center justify-center min-h-screen">
    <div class="container mx-auto bg-white rounded-xl shadow-lg p-6 sm:p-8 lg:p-10 max-w-3xl border-t-4 border-red-600 relative">
        <div id="cart-icon-container" class="absolute top-4 right-4 cursor-pointer flex items-center justify-center bg-red-600 text-white rounded-full p-3 shadow-lg hover:bg-red-700 transition-colors z-10" onclick="showPage('order-summary')">
            <i class="fas fa-shopping-cart text-xl"></i>
            <span id="cart-count" class="ml-2 text-lg font-bold">0</span>
        </div>

        <div class="text-center mb-6 mt-4">
            <img src="https://i.ibb.co/YFhQZvBG/Whats-App-Image-2025-06-06-at-14-24-25.jpg" alt="Logo Rotella Pizzaria" class="mx-auto w-48 sm:w-64 h-auto rounded-lg shadow-md">
            <a href="https://www.instagram.com/rotellapizzaria" target="_blank" class="mt-4 inline-block text-red-600 hover:text-red-800 font-semibold text-lg">
                Nos siga no Instagram: @rotellapizzaria
            </a>
        </div>

        <div id="main-menu" class="page-section">
            <h2 class="text-2xl sm:text-3xl font-semibold text-gray-800 text-center mb-8">Nosso Cardápio Delicioso!</h2>

            <div class="mb-10">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6">Combos Especiais</h3>
                <p class="text-sm text-gray-600 mb-4 italic text-center">
                    *Obs: Válido somente para sabores tradicionais de pizza.
                </p>
                
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="combo" data-item-id="combo1" data-item-name="Combo 1" data-item-price="39.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Combo 1</p>
                        <p class="text-sm text-gray-600 mt-1">Pizza grande (até dois sabores) + Coca-cola ou Fanta laranja de 1L</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 39,90</p>
                </div>

                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="combo" data-item-id="combo2" data-item-name="Combo 2" data-item-price="74.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Combo 2</p>
                        <p class="text-sm text-gray-600 mt-1">2 Pizzas grandes (até dois sabores cada) + Coca-cola ou Fanta laranja de 2L</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 74,90</p>
                </div>
            </div>

            <div class="mb-10">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6">Pizzas</h3>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="pizza-tradicional" data-item-id="pizza-tradicional-grande" data-item-name="Pizza Grande Tradicional" data-item-price="34.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Pizza Grande Tradicional</p>
                        <p class="text-sm text-gray-600 mt-1">Até dois sabores</p>
                    </div>
                    <!-- Displaying old price with strikethrough and new price -->
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">
                        <span class="line-through text-gray-500 text-base mr-2">R$ 44,90</span> R$ 34,90
                    </p>
                </div>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="pizza-especial" data-item-id="pizza-especial-grande" data-item-name="Pizza Grande Especial" data-item-price="44.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Pizza Grande Especial</p>
                        <p class="text-sm text-gray-600 mt-1">Até dois sabores</p>
                    </div>
                    <!-- Displaying old price with strikethrough and new price for Pizza Grande Especial -->
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">
                        <span class="line-through text-gray-500 text-base mr-2">R$ 54,90</span> R$ 44,90
                    </p>
                </div>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="pizza-media" data-item-id="pizza-media" data-item-name="Pizza Média Tradicional" data-item-price="29.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Pizza Média Tradicional</p>
                        <p class="text-sm text-gray-600 mt-1">Até dois sabores</p>
                    </div>
                    <!-- Displaying old price with strikethrough and new price for Pizza Média Tradicional -->
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">
                        <span class="line-through text-gray-500 text-base mr-2">R$ 34,90</span> R$ 29,90
                    </p>
                </div>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="pizza-especial" data-item-id="pizza-especial-media" data-item-name="Pizza Média Especial" data-item-price="39.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Pizza Média Especial</p>
                        <p class="text-sm text-gray-600 mt-1">Até dois sabores</p>
                    </div>
                    <!-- Displaying old price with strikethrough and new price for Pizza Média Especial -->
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">
                        <span class="line-through text-gray-500 text-base mr-2">R$ 44,90</span> R$ 39,90
                    </p>
                </div>
            </div>
            
            <div class="mb-10">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6">Esfirras</h3>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="esfirra-tradicional" data-item-id="esfirra-tradicional" data-item-name="Esfirra Salgada Tradicional" data-item-price="6.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Esfirra Salgada Tradicional</p>
                        <p class="text-sm text-gray-600 mt-1">Sabores tradicionais</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 6,90</p>
                </div>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="esfirra-especial" data-item-id="esfirra-especial" data-item-name="Esfirra Salgada Especial" data-item-price="7.90">
                    <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Esfirra Salgada Especial</p>
                        <p class="text-sm text-gray-600 mt-1">Todos os sabores</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 7,90</p>
                </div>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-4 px-3 rounded-lg border border-gray-200 mb-4 clickable-item"
                     data-item-type="esfirra-doce" data-item-id="esfirra-doce" data-item-name="Esfirra Doce" data-item-price="7.90"> <div class="flex-grow">
                        <p class="text-lg font-bold text-gray-900">Esfirra Doce</p>
                        <p class="text-sm text-gray-600 mt-1">Brigadeiro e Romeu e Julieta</p>
                    </div>
                    <p class="text-xl font-extrabold text-red-700 mt-2 sm:mt-0">R$ 7,90</p>
                </div>
            </div>
            
            <div class="text-center mt-10 mb-6">
                <button onclick="window.open('https://wa.me/92986161640?text=Ol%C3%A1%2C%20gostaria%20de%20fazer%20um%20pedido!', '_blank')" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50">
                    <i class="fab fa-whatsapp mr-2"></i> Falar com um atendente
                </button>
            </div>
            
        </div>

        <div id="flavor-selection" class="page-section hidden">
            <h2 class="text-2xl sm:text-3xl font-semibold text-gray-800 text-center mb-8">Personalize seu Pedido</h2>

            <div id="item-info" class="text-center text-lg text-gray-700 mb-6 p-4 bg-red-50 rounded-lg">
                </div>

            <div id="crust-options-section" class="mb-10 hidden">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6">Borda Recheada</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8">
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="stuffed-crust" value="Sem Borda Recheada" data-crust-price="0.00" data-crust-id="no-crust" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500" checked>
                        <span class="ml-3 text-lg text-gray-800 font-medium">Sem Borda Recheada</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="stuffed-crust" value="Borda Recheada Catupiry" data-crust-price="10.00" data-crust-id="catupiry-crust" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Borda Recheada Catupiry +R$10,00</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="stuffed-crust" value="Borda Recheada Chocolate" data-crust-price="10.00" data-crust-id="chocolate-crust" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Borda Recheada Chocolate +R$10,00</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="stuffed-crust" value="Borda Recheada Romeu e Julieta" data-crust-price="10.00" data-crust-id="rj-crust" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Borda Recheada Romeu e Julieta +R$10,00</span>
                    </label>
                </div>
            </div>

            <div class="mb-10">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6">Selecione seus Sabores</h3>
                <p id="flavor-instruction-text" class="text-md text-gray-600 text-center mb-6">
                    </p>

                <div id="flavor-options" class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8">
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Portuguesa" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Portuguesa</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Calabresa" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Calabresa</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Mussarela" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Mussarela</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Marguerita" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Marguerita</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Frango com Catupiry" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Frango com Catupiry</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Calabresa com Catupiry" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Calabresa com Catupiry</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Brigadeiro" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Brigadeiro</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="checkbox" name="flavor" value="Romeu e Julieta" class="form-checkbox h-5 w-5 text-red-600 rounded focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Romeu e Julieta</span>
                    </label>
                </div>
            </div>

            <div class="mb-10">
                <h3 class="text-2xl sm:text-2xl font-bold text-red-600 border-b-2 border-red-400 pb-2 mb-6" id="beverage-heading"></h3> <div id="beverage-options" class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8">
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="beverage" value="Coca-cola 1L" data-beverage-price="9.90" data-beverage-id="coca-1l" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Coca-cola 1L - R$ 9,90</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="beverage" value="Coca-cola 2L" data-beverage-price="13.90" data-beverage-id="coca-2l" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Coca-cola 2L - R$ 13,90</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="beverage" value="Fanta Laranja 1L" data-beverage-price="9.90" data-beverage-id="fanta-1l" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Fanta Laranja 1L - R$ 9,90</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="beverage" value="Fanta Laranja 2L" data-beverage-price="12.90" data-beverage-id="fanta-2l" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Fanta Laranja 2L - R$ 12,90</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm hover:shadow-md transition-all cursor-pointer bg-white">
                        <input type="radio" name="beverage" value="Nenhuma bebida" data-beverage-price="0.00" data-beverage-id="no-beverage" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500" checked>
                        <span class="ml-3 text-lg text-gray-800 font-medium">Nenhuma bebida</span>
                    </label>
                </div>
            </div>

            <div class="text-center space-x-4">
                <button id="add-to-cart-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50" disabled>
                    Adicionar ao Carrinho
                </button>
                <button onclick="showPage('main-menu')" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50">
                    Voltar ao Cardápio
                </button>
            </div>
        </div>

        <div id="order-summary" class="page-section hidden">
            <h2 class="text-2xl sm:text-3xl font-semibold text-gray-800 text-center mb-8">Seu Carrinho</h2>

            <div id="cart-items-container" class="bg-gray-50 p-6 rounded-lg shadow-inner mb-8">
                <p id="empty-cart-message" class="text-center text-gray-600 italic hidden">Seu carrinho está vazio.</p>
            </div>

            <div class="mb-6 p-4 border rounded-lg bg-white shadow-sm">
                <h3 class="text-xl font-bold text-gray-800 mb-3">Endereço de Entrega</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label for="address-street" class="block text-sm font-medium text-gray-700">Rua</label>
                        <input type="text" id="address-street" placeholder="Ex: Av. Brasil" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                    <div>
                        <label for="address-number" class="block text-sm font-medium text-gray-700">Número</label>
                        <input type="text" id="address-number" placeholder="Ex: 123" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                    <div>
                        <label for="address-neighborhood" class="block text-sm font-medium text-gray-700">Bairro</label>
                        <input type="text" id="address-neighborhood" placeholder="Ex: Centro" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                    <div class="sm:col-span-2">
                        <label for="address-reference" class="block text-sm font-medium text-gray-700">Ponto de Referência (Opcional)</label>
                        <input type="text" id="address-reference" placeholder="Ex: Próximo à praça" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                </div>
            </div>

            <div class="mb-6 p-4 border rounded-lg bg-white shadow-sm">
                <h3 class="text-xl font-bold text-gray-800 mb-3">Forma de pagamento</h3>
                <div class="grid grid-cols-1 sm:grid-cols-4 gap-4">
                    <label class="flex items-center p-3 border rounded-lg shadow-sm cursor-pointer bg-white">
                        <input type="radio" name="payment-method" value="Pix" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500" checked>
                        <span class="ml-3 text-lg text-gray-800 font-medium">Pix</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm cursor-pointer bg-white">
                        <input type="radio" name="payment-method" value="Crédito" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Crédito</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm cursor-pointer bg-white">
                        <input type="radio" name="payment-method" value="Débito" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Débito</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-lg shadow-sm cursor-pointer bg-white">
                        <input type="radio" name="payment-method" value="Dinheiro" class="form-radio h-5 w-5 text-red-600 focus:ring-red-500">
                        <span class="ml-3 text-lg text-gray-800 font-medium">Dinheiro</span>
                    </label>
                </div>
            </div>


            <div class="text-right text-3xl font-extrabold text-red-700 mt-6 pt-4 border-t-2 border-red-300 mb-8">
                <span class="font-semibold">Total do Pedido:</span> <span id="cart-total-price">R$ 0,00</span>
            </div>

            <div class="text-center space-x-4">
                <button id="place-order-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50" disabled>
                    Enviar Pedido
                </button>
                <button onclick="showPage('main-menu')" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50">
                    Voltar ao Cardápio
                </button>
            </div>
        </div>
        
        <p class="text-center text-gray-500 text-sm mt-10">Obrigado por escolher Rotella Pizzaria! Bom apetite!</p>
    </div>

    <script>
        // Array to store items in the cart (pizza/combo and separate drinks)
        let cart = []; 
        let selectedItem = {}; // Item (pizza/combo) being configured on the flavor selection screen
        let selectedBeverage = { name: 'Nenhuma bebida', price: 0, id: 'no-beverage' }; // Selected beverage on the selection screen
        let selectedCrust = { name: 'Sem Borda Recheada', price: 0, id: 'no-crust' }; // Selected crust
        let deliveryFee = 0; // Stores the calculated delivery fee, now always 0

        // const ORIGIN_ZIP_CODE = '69095510'; // Fixed origin ZIP code - Commented out
        // const Maps_API_KEY = 'AIzaSyBd6-d4xDeEdHCILpv_c5xqGTBAR8o8xm4'; // Your API key - Commented out

        // Function to show the correct page and hide others
        function showPage(pageId) {
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(pageId).classList.remove('hidden');

            // If it's the order summary page, update the cart
            if (pageId === 'order-summary') {
                renderCart();
            }
        }

        // Function to update the item count on the cart icon
        function updateCartIconCount() {
            let totalItemsInCart = 0;
            cart.forEach(item => {
                totalItemsInCart += item.quantity;
            });
            document.getElementById('cart-count').textContent = totalItemsInCart;
        }

        // === Main Menu Logic ===
        document.querySelectorAll('.clickable-item').forEach(item => {
            item.addEventListener('click', function() {
                selectedItem = {
                    type: this.dataset.itemType, // 'combo', 'pizza-tradicional', 'pizza-especial', 'pizza-media', 'esfirra-tradicional', 'esfirra-especial', 'esfirra-doce'
                    id: this.dataset.itemId,
                    name: this.dataset.itemName,
                    price: parseFloat(this.dataset.itemPrice)
                };
                
                // Reset flavor checkboxes and button when going to flavor selection
                document.querySelectorAll('input[name="flavor"]').forEach(cb => {
                    cb.checked = false;
                    cb.disabled = false;
                    cb.closest('label').classList.remove('disabled-option'); // Remove disabled style
                });
                
                // Reset beverage selection to "Nenhuma bebida"
                selectedBeverage = { name: 'Nenhuma bebida', price: 0, id: 'no-beverage' };
                document.querySelectorAll('input[name="beverage"]').forEach(radio => {
                    radio.checked = (radio.value === 'Nenhuma bebida'); // Check "Nenhuma bebida" option
                });

                // Reset crust selection to "Sem Borda Recheada"
                selectedCrust = { name: 'Sem Borda Recheada', price: 0, id: 'no-crust' };
                document.querySelectorAll('input[name="stuffed-crust"]').forEach(radio => {
                    radio.checked = (radio.value === 'Sem Borda Recheada');
                });


                // Update flavor selection instructions text and button state
                updateFlavorSelectionInstructions();
                updateFinalizeButtonState(); 
                
                // Update item information on the flavor selection page
                document.getElementById('item-info').innerHTML = `Você selecionou: <span class="font-bold">${selectedItem.name}</span> por <span class="font-bold">R$ ${selectedItem.price.toFixed(2).replace('.', ',')}</span>`;
                
                // Redirect to flavor selection for items that require flavor
                if (selectedItem.id.includes('pizza') || selectedItem.id.includes('combo') || selectedItem.id.includes('esfirra')) {
                    showPage('flavor-selection');
                } else {
                    // For other items that don't need flavor selection (if any in the future)
                    // Add the item directly to the cart if no flavor selection is needed
                    cart.push({
                        name: selectedItem.name,
                        price: selectedItem.price,
                        quantity: 1,
                        flavors: [],
                        type: selectedItem.type,
                        id: selectedItem.id 
                    });
                    renderCart(); // Render cart and update icon (called here for items without selection)
                    showPage('order-summary');
                }
            });
        });

        // === Flavor and Beverage Selection Logic ===
        const flavorCheckboxes = document.querySelectorAll('input[name="flavor"]');
        const beverageRadios = document.querySelectorAll('input[name="beverage"]');
        const stuffedCrustRadios = document.querySelectorAll('input[name="stuffed-crust"]'); // Reference to crusts
        const crustOptionsSection = document.getElementById('crust-options-section'); // Reference to crust section

        const addToCartBtn = document.getElementById('add-to-cart-btn'); // "Add to Cart" button
        const flavorInstructionText = document.getElementById('flavor-instruction-text');
        const beverageHeading = document.getElementById('beverage-heading'); // Reference to beverage heading


        const traditionalFlavors = ['Portuguesa', 'Calabresa', 'Mussarela', 'Marguerita'];
        const sweetFlavors = ['Brigadeiro', 'Romeu e Julieta']; // Specific sweet flavors


        // Function to update flavor selection instructions and enable/disable checkboxes
        function updateFlavorSelectionInstructions() {
            // Re-enable all checkboxes initially before applying new restrictions
            flavorCheckboxes.forEach(cb => {
                cb.checked = false; // Ensure no flavor is pre-selected
                cb.disabled = false;
                cb.closest('label').classList.remove('disabled-option');
                cb.closest('label').style.display = 'flex'; // Ensure they are visible before filtering
            });

            // Adjust beverage heading text
            if (selectedItem.type === 'combo') {
                beverageHeading.textContent = 'Seu combo já possui refrigerante, deseja acrescentar mais alguma bebida?'; // Adjusted text for combos
            } else {
                beverageHeading.textContent = 'Deseja acrescentar refrigerante ao seu pedido ?'; // Default text for other items
            }

            // Logic for displaying and enabling stuffed crusts
            if (selectedItem.id === 'pizza-tradicional-grande' || selectedItem.id === 'pizza-especial-grande') {
                crustOptionsSection.style.display = 'block'; // Show crust section
                stuffedCrustRadios.forEach(radio => {
                    radio.disabled = false;
                    radio.closest('label').classList.remove('disabled-option');
                    radio.closest('label').style.display = 'flex'; // Ensure crusts are visible
                });
            } else {
                crustOptionsSection.style.display = 'none'; // Hide crust section
                stuffedCrustRadios.forEach(radio => { // Disable and uncheck crusts if section is hidden
                    radio.checked = false;
                    radio.disabled = true;
                    if (radio.dataset.crustId === 'no-crust') { // Ensure "Sem Borda Recheada" is checked by default, even if hidden
                        radio.checked = true;
                        selectedCrust = { name: 'Sem Borda Recheada', price: 0, id: 'no-crust' };
                    }
                });
            }


            if (selectedItem.id === 'combo2') {
                flavorInstructionText.textContent = 'Para o Combo 2 (2 pizzas grandes), escolha 1 sabor para ambas as pizzas, ou até 4 sabores para pizzas diferentes.';
                // For combos, only traditional flavors are allowed
                flavorCheckboxes.forEach(cb => {
                    if (!traditionalFlavors.includes(cb.value)) {
                        cb.disabled = true;
                        cb.closest('label').classList.add('disabled-option');
                        cb.closest('label').style.display = 'none'; // Hide non-traditional flavors
                    }
                });
            } else if (selectedItem.id === 'esfirra-doce') { 
                flavorInstructionText.textContent = 'Escolha apenas 1 sabor para sua esfirra doce (Brigadeiro ou Romeu e Julieta).';
                 flavorCheckboxes.forEach(cb => {
                    if (!sweetFlavors.includes(cb.value)) { // Disable if not a sweet flavor
                        cb.disabled = true;
                        cb.closest('label').classList.add('disabled-option');
                        cb.closest('label').style.display = 'none'; // Hide non-sweet flavors
                    }
                });
            }
            else if (selectedItem.id === 'combo1' || selectedItem.id === 'pizza-tradicional-grande' || selectedItem.id === 'pizza-media') { 
                // ADJUSTMENT MADE HERE FOR "PIZZA GRANDE TRADICIONAL" FOR UP TO 2 FLAVORS
                flavorInstructionText.textContent = `Escolha até 2 sabores para sua pizza. Se selecionar apenas 1, a pizza será inteira desse sabor.`;
                
                // For Combo 1, Traditional Pizzas and Medium Pizza, only traditional flavors are allowed
                flavorCheckboxes.forEach(cb => {
                    if (!traditionalFlavors.includes(cb.value)) {
                        cb.disabled = true;
                        cb.closest('label').classList.add('disabled-option');
                        cb.closest('label').style.display = 'none'; // Hide non-traditional flavors
                    }
                });
            } else if (selectedItem.id === 'esfirra-tradicional') { 
                flavorInstructionText.textContent = 'Escolha apenas 1 sabor para sua esfirra tradicional.';
                // For Traditional Esfirra, only traditional flavors are allowed
                flavorCheckboxes.forEach(cb => {
                    if (!traditionalFlavors.includes(cb.value)) {
                        cb.disabled = true;
                        cb.closest('label').classList.add('disabled-option');
                        cb.closest('label').style.display = 'none'; // Hide non-traditional flavors
                    }
                });
            }
            else if (selectedItem.id === 'pizza-especial-grande' || selectedItem.id === 'pizza-especial-media' || selectedItem.id === 'esfirra-especial') { 
                if (selectedItem.id === 'pizza-especial-grande' || selectedItem.id === 'pizza-especial-media') {
                    flavorInstructionText.textContent = `Para sua ${selectedItem.name}, escolha até 2 sabores para sua pizza. Se selecionar apenas 1, a pizza será inteira desse sabor.`;
                } else { // For esfirra-especial
                    flavorInstructionText.textContent = `Para sua ${selectedItem.name}, escolha apenas 1 sabor.`;
                }
                
                // For special esfirra and special pizzas, all savory flavors are allowed
                flavorCheckboxes.forEach(cb => {
                    if (sweetFlavors.includes(cb.value)) { // Disable and hide if it's a sweet flavor
                        cb.disabled = true;
                        cb.closest('label').classList.add('disabled-option');
                        cb.closest('label').style.display = 'none'; // Hide sweet flavors
                    }
                });
            } else {
                flavorInstructionText.textContent = 'Escolha seus sabores.'; // Generic for other items
            }
        }

        // Add listener for each flavor checkbox
        flavorCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                const checkedCount = document.querySelectorAll('input[name="flavor"]:checked').length;
                let maxAllowedFlavors;

                if (selectedItem.id === 'combo2') {
                    maxAllowedFlavors = 4;
                } else if (selectedItem.id.includes('esfirra')) { // Savory (both) and Sweet Esfirra allow only 1 flavor
                    maxAllowedFlavors = 1;
                }
                else if (selectedItem.id.includes('pizza')) { // This includes all individual pizzas and Combo1
                    maxAllowedFlavors = 2; 
                } else {
                    maxAllowedFlavors = 2; // Default (fallback)
                }

                if (checkedCount >= maxAllowedFlavors) {
                    flavorCheckboxes.forEach(cb => {
                        // Only disable if not checked AND if not a flavor already disabled by category (e.g. non-traditional or non-sweet for sweet esfirra)
                        if (!cb.checked && !cb.disabled) { 
                            cb.disabled = true;
                        }
                    });
                } else {
                    // Re-enable checkboxes that were not disabled by pizza category restriction
                    flavorCheckboxes.forEach(cb => {
                        if (!cb.checked) { // If not checked
                            if (selectedItem.id === 'combo2' || selectedItem.id === 'combo1' || selectedItem.id === 'pizza-tradicional-grande' || selectedItem.id === 'pizza-media' || selectedItem.id === 'esfirra-tradicional') { 
                                // Rule for traditional items: only re-enable traditional
                                if (traditionalFlavors.includes(cb.value)) {
                                    cb.disabled = false;
                                }
                            } else if (selectedItem.id === 'esfirra-doce') { // Rule for sweet esfirra: only re-enable sweet
                                if (sweetFlavors.includes(cb.value)) {
                                    cb.disabled = false;
                                }
                            }
                            else if (selectedItem.id === 'esfirra-especial' || selectedItem.id === 'pizza-especial-grande' || selectedItem.id === 'pizza-especial-media') {
                                // Rule for special esfirra and special pizzas: re-enable everything that is not sweet
                                if (!sweetFlavors.includes(cb.value)) {
                                     cb.disabled = false;
                                }
                            }
                            else { // For other types (fallback), enable all
                                cb.disabled = false;
                            }
                        }
                    });
                }
                updateFinalizeButtonState();
            });
        });

        // Add listener for each beverage radio button
        beverageRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                selectedBeverage = {
                    name: radio.value,
                    price: parseFloat(radio.dataset.beveragePrice),
                    id: radio.dataset.beverageId // Add beverage ID
                };
                updateFinalizeButtonState(); 
            });
        });

        // Add listener for each stuffed crust radio button
        stuffedCrustRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                selectedCrust = {
                    name: radio.value,
                    price: parseFloat(radio.dataset.crustPrice),
                    id: radio.dataset.crustId
                };
                // Crust selection does not change the "Add to Cart" button's enabled state
                // as the button already depends on flavor selection.
            });
        });


        // Function to update the state of the "Add to Cart" button
        function updateFinalizeButtonState() {
            const checkedFlavorsCount = document.querySelectorAll('input[name="flavor"]:checked').length;
            let minFlavorsToEnableButton;

            // Determine the minimum number of flavors to enable the button
            if (selectedItem.id === 'combo2') {
                minFlavorsToEnableButton = 1; 
            } else if (selectedItem.id.includes('esfirra')) { // Savory (both) and Sweet Esfirra allow only 1 flavor
                minFlavorsToEnableButton = 1;
            }
            else if (selectedItem.id.includes('pizza') || selectedItem.type === 'combo') { // Includes all pizza types and Combo1
                minFlavorsToEnableButton = 1; 
            } else {
                minFlavorsToEnableButton = 0; 
            }

            // The "Add to Cart" button is enabled if the flavor condition is met
            const isFlavorConditionMet = checkedFlavorsCount >= minFlavorsToEnableButton;
            addToCartBtn.disabled = !isFlavorConditionMet; // Use addToCartBtn
        }

        // Click event for the "Add to Cart" button
        addToCartBtn.addEventListener('click', () => { // Use addToCartBtn
            const selectedFlavors = Array.from(document.querySelectorAll('input[name="flavor"]:checked'))
                                       .map(cb => cb.value);
            
            // Add pizza/combo/esfirra to cart
            cart.push({
                name: selectedItem.name,
                price: selectedItem.price + selectedCrust.price, // PRICE ADJUSTED WITH CRUST
                quantity: 1, 
                flavors: selectedFlavors,
                type: selectedItem.type,
                id: selectedItem.id,
                crust: selectedCrust.name !== 'Sem Borda Recheada' ? selectedCrust : null // Store selected crust
            });

            // If a beverage was selected (and is not "Nenhuma bebida"), add it as a separate item
            if (selectedBeverage.name !== 'Nenhuma bebida') {
                cart.push({
                    name: selectedBeverage.name,
                    price: selectedBeverage.price,
                    quantity: 1, // Beverage is added as 1 unit by default
                    type: 'beverage', // New type for beverages
                    id: selectedBeverage.id 
                });
            }

            updateCartIconCount(); // Update cart icon count
            showPage('order-summary'); // Go to order summary/cart screen
        });

        // === Shopping Cart / Summary Logic ===
        const cartItemsContainer = document.getElementById('cart-items-container');
        const cartTotalPriceElement = document.getElementById('cart-total-price');
        const placeOrderBtn = document.getElementById('place-order-btn');
        const emptyCartMessage = document.getElementById('empty-cart-message');

        // References to address fields
        const addressStreetInput = document.getElementById('address-street');
        const addressNumberInput = document.getElementById('address-number');
        const addressNeighborhoodInput = document.getElementById('address-neighborhood');
        const addressReferenceInput = document.getElementById('address-reference');

        // Variable to store the selected payment option
        let selectedPaymentMethod = 'Pix'; // Pix as default

        // Listener for payment radio buttons
        document.querySelectorAll('input[name="payment-method"]').forEach(radio => {
            radio.addEventListener('change', () => {
                selectedPaymentMethod = radio.value;
            });
        });


        function renderCart() {
            cartItemsContainer.innerHTML = ''; // Clear current cart content
            
            if (cart.length === 0) {
                emptyCartMessage.classList.remove('hidden');
                placeOrderBtn.disabled = true;
            } else {
                emptyCartMessage.classList.add('hidden');
                placeOrderBtn.disabled = false;

                cart.forEach((item, index) => {
                    let itemDisplayPrice = item.price; // Unit price for display
                    let itemDescription = '';

                    if (item.type === 'beverage') {
                        itemDescription = `Bebida: ${item.name}`;
                    } else { // It's a pizza or combo or esfirra
                        // Build flavor text
                        let flavorsText = '';
                        if (item.flavors && item.flavors.length > 0) {
                            // Adjusted for esfirras: if it's an esfirra and only 1 flavor, show as whole
                            if (item.flavors.length === 1 && item.id.includes('esfirra')) { 
                                flavorsText = ` (${item.flavors[0]} inteira)`;
                            } else if (item.flavors.length === 1) { 
                                flavorsText = ` (${item.flavors[0]} inteira)`;
                            }
                             else if (item.flavors.length === 2) { 
                                flavorsText = ` (${item.flavors[0]} e ${item.flavors[1]})`;
                            } else if (item.flavors.length >= 2 && item.id === 'combo2') { 
                                flavorsText = item.flavors.slice(0, -1).join(', ') + ' e ' + item.flavors[item.flavors.length - 1];
                            }
                        } else {
                            flavorsText = 'N/A';
                        }
                        itemDescription = `Sabores: ${flavorsText}`;

                        // Add stuffed crust to description
                        if (item.crust && item.crust.name !== 'Sem Borda Recheada') {
                            crustText = ` (Borda: ${item.crust.name})`;
                        }
                    }
                    
                    const cartItemHtml = `
                        <div class="flex items-center justify-between py-3 border-b border-gray-200 last:border-b-0">
                            <div class="flex-grow">
                                <p class="text-lg font-bold text-gray-900">${item.name}</p>
                                <p class="text-sm text-gray-600">${itemDescription}</p>
                                <p class="text-sm text-gray-700 font-semibold">R$ ${itemDisplayPrice.toFixed(2).replace('.', ',')} /un</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <button onclick="updateQuantity(${index}, -1)" class="bg-red-500 hover:bg-red-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-lg">-</button>
                                <span class="text-xl font-bold">${item.quantity}</span>
                                <button onclick="updateQuantity(${index}, 1)" class="bg-green-500 hover:bg-green-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-lg">+</button>
                            </div>
                        </div>
                    `;
                    cartItemsContainer.innerHTML += cartItemHtml;
                });
                updateCartIconCount(); // Update cart icon count
            }
            calculateTotalCartPrice(); // Recalculate total (now without delivery fee)
        }

        // Function to update the quantity of an item in the cart
        function updateQuantity(index, change) {
            if (cart[index]) {
                cart[index].quantity += change;
                if (cart[index].quantity <= 0) {
                    cart.splice(index, 1); // Remove item if quantity is 0 or less
                }
            }
            renderCart(); // Re-render cart to reflect changes
        }

        // Functions related to delivery fee calculation were commented out/removed
        /*
        function calculateDeliveryFee(distance) { ... }
        const ORIGIN_ZIP_CODE = '69095510';
        const Maps_API_KEY = 'AIzaSyBd6-d4xDeEdHCILpv_c5xqGTBAR8o8xm4';
        async function getDistanceViaGoogleMapsAPI(originZip, destinationZip) { ... }
        function getSimulatedDistance(destinationZip) { ... }
        */

        // Function to calculate and display the cart total, WITHOUT the delivery fee
        function calculateTotalCartPrice() {
            let subtotal = 0;
            cart.forEach(item => {
                subtotal += item.price * item.quantity;
            });

            // deliveryFee is now always 0, so just sum the subtotal
            let total = subtotal; // Do not sum deliveryFee
            cartTotalPriceElement.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
        }

        // The event for the "Calcular Taxa" button was removed
        // calculateDeliveryBtn.addEventListener('click', async () => { ... });

        // Event for the "Enviar Pedido" button
        placeOrderBtn.addEventListener('click', () => {
            const whatsappNumber = '92986161640';
            const message = prepareWhatsAppMessage();
            const whatsappLink = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappLink, '_blank'); // Open WhatsApp link in a new tab
        });

        // Function to prepare the WhatsApp message
        function prepareWhatsAppMessage() {
            let message = 'Olá! Gostaria de fazer um pedido na Rotella Pizzaria:\n\n*Itens do Pedido:*\n';

            cart.forEach(item => {
                let itemDetails = `- ${item.quantity}x ${item.name}`;
                if (item.type !== 'beverage') { // If it's pizza/combo, add flavors and crust
                    let flavorsText = '';
                    if (item.flavors && item.flavors.length > 0) {
                        if (item.id.includes('esfirra') && item.flavors.length === 1) { 
                            flavorsText = ` (${item.flavors[0]} inteira)`;
                        } else if (item.flavors.length === 1) { 
                            flavorsText = ` (${item.flavors[0]} inteira)`;
                        } else if (item.flavors.length === 2) { 
                            flavorsText = ` (${item.flavors[0]} e ${item.flavors[1]})`;
                        } else { 
                            flavorsText = ` (${item.flavors.join(', ')})`;
                        }
                    }
                    let crustText = '';
                    if (item.crust && item.crust.name !== 'Sem Borda Recheada') {
                        crustText = ` (Borda: ${item.crust.name})`;
                    }
                    itemDetails += flavorsText + crustText;
                }
                message += itemDetails + ` - R$ ${item.price.toFixed(2).replace('.', ',')}\n`;
            });

            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            message += `\n*Total do Pedido:* R$ ${subtotal.toFixed(2).replace('.', ',')}\n\n`; // Subtotal only
            
            message += `*Endereço de Entrega:*\n`;
            message += `Rua: ${addressStreetInput.value || 'Não informado'}\n`;
            message += `Número: ${addressNumberInput.value || 'Não informado'}\n`;
            message += `Bairro: ${addressNeighborhoodInput.value || 'Não informado'}\n`;
            if (addressReferenceInput.value) {
                message += `Ponto de Referência: ${addressReferenceInput.value}\n`;
            } else {
                message += `Ponto de Referência: Não informado\n`;
            }
            
            message += `\n*Forma de Pagamento:* ${selectedPaymentMethod}\n\n`;
            message += 'Aguardamos a confirmação!';

            return message;
        }


        // Initialize by showing the main menu page and updating the cart icon
        document.addEventListener('DOMContentLoaded', () => {
            showPage('main-menu');
            updateCartIconCount(); // Ensure cart count is displayed correctly on load
        });
    </script>
</body>
</html>
