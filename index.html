<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotella Pizzaria – Cardápio</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom font for a more inviting look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Pacifico&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            /* Background with the provided image, adjusted for "less zoom" and better quality */
            background-image:
                linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), /* Dark overlay for better text contrast */
                url('https://i.ibb.co/s9k1T8P0/pizza-de-pepperoni-italiana-classica-e-prato-vazio-vista-superior-foto-vertical-foto-de-alta-qualida.jpg');
            background-size: auto 100vh; /* Scales image to fill viewport height, preserving aspect ratio */
            background-position: center; /* Centers the background image */
            background-attachment: fixed; /* Keeps background fixed during scroll */
            background-repeat: no-repeat; /* Prevents image repetition */
            background-color: #333; /* Dark fallback color to fill gaps if image doesn't cover full width */
        }
        .menu-card {
            background-color: rgba(255, 255, 255, 0.90); /* Slightly more transparent white for background to show through */
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2); /* Stronger shadow for professionalism */
            border-radius: 1.5rem; /* Slightly less rounded corners */
            border: 2px solid #CD853F; /* Reduced border thickness */
            padding: 2rem; /* Reduced padding for more vertical feel */
            max-width: 32rem; /* Max width to make it more vertical on larger screens */
            transition: transform 0.3s ease; /* Smooth transition on hover */
        }
        .menu-card:hover {
            transform: translateY(-5px); /* Slight lift on hover */
        }
        .section-title {
            font-family: 'Pacifico', cursive; /* Playful font for titles */
            color: #CC5500; /* Darker, richer orange for titles */
            text-shadow: 1px 1px 3px rgba(0,0,0,0.15); /* More pronounced shadow */
        }
        .item-name {
            color: #333; /* Darker text for item names */
            font-weight: 600; /* Slightly bolder for clarity */
            letter-spacing: 0.025em; /* A bit of letter spacing for elegance */
            text-align: center; /* Ensure name is centered */
        }
        .item-ingredients {
            font-size: 0.85rem; /* Smaller font for ingredients */
            color: #555; /* Slightly muted color for ingredients */
            text-align: center; /* Center ingredients text */
            margin-top: 0.25rem; /* Small space between name and ingredients */
            line-height: 1.2; /* Adjust line height for better readability */
            padding: 0 0.5rem; /* Small padding left/right */
        }
        .item-price {
            color: #E44D26; /* Brighter red-orange for prices */
            font-weight: 700;
        }
        .footer-phone-container {
            background-color: #E44D26; /* Brighter, more inviting red-orange for phone number */
            padding: 0.75rem 1.5rem;
            border-radius: 9999px; /* Fully rounded pill shape */
            font-weight: 700;
            letter-spacing: 0.05em;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: inline-block; /* Allows padding and rounding to work */
            transition: background-color 0.3s ease; /* Smooth transition on hover */
        }
        .footer-phone-container:hover {
            background-color: #FF6347; /* Tomato red on hover */
        }
        .footer-phone-link {
            color: #fff; /* White text for phone number */
            text-decoration: none; /* Remove underline from link */
            font-size: 1.1rem; /* Reduced font size for better fit */
            line-height: 1.5rem; /* Adjusted line height */
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .footer-phone-link {
                font-size: 1.25rem; /* text-xl for small screens */
                line-height: 1.75rem; /* leading-7 */
            }
        }
        @media (min-width: 768px) { /* md breakpoint */
            .footer-phone-link {
                font-size: 1.5rem; /* text-2xl for medium screens */
                line-height: 2rem; /* leading-8 */
            }
        }

        /* Style for clickable items */
        .pizza-link {
            display: flex;
            flex-direction: column; /* Stack name and ingredients vertically */
            align-items: center;
            justify-content: center; /* Center content within the link */
            flex-grow: 1; /* Make the link fill the list item */
            text-decoration: none; /* Remove underline by default */
            color: inherit; /* Inherit text color */
            padding: 0.75rem; /* Match padding of the li */
            border-radius: 0.5rem; /* Match border-radius of the li */
            transition: background-color 0.2s ease-in-out, transform 0.2s ease; /* Smooth transition on hover */
            text-align: center; /* Ensure text inside is centered */
        }
        .pizza-link:hover {
            background-color: #F5DEB3; /* Wheat color on hover */
            transform: scale(1.02); /* Slight scale up on hover */
        }
        .combo-link {
            display: flex;
            align-items: center;
            justify-content: space-between; /* Space between name and price */
            flex-grow: 1;
            text-decoration: none;
            color: inherit;
            padding: 0.75rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease;
            width: 100%; /* Ensure the link takes full width of the li */
        }
        .combo-link:hover {
            background-color: #E8D7F1; /* Lighter purple on hover */
            transform: scale(1.02);
        }
        .observation {
            font-size: 0.9rem; /* Smaller font for observations */
            color: #666; /* Slightly lighter text for observations */
            text-align: center;
            margin-top: 1rem; /* Space above the observation */
        }
        .pizzaria-logo {
            max-width: 80%; /* Ensure logo is responsive */
            height: auto;
            margin: 0 auto 2rem auto; /* Center logo and add some bottom margin */
            display: block; /* Make it a block element to center with margin auto */
        }
        .footer-observation {
            font-size: 0.95rem; /* Slightly larger than other observations for emphasis */
            color: #333; /* Darker text for visibility */
            text-align: center;
            margin-top: 2rem; /* More space above this final observation */
            font-weight: 500;
        }
        .pizza-dough-observation {
            font-size: 0.95rem;
            color: #333;
            text-align: center;
            margin-top: 1.5rem; /* Space after the pizza sections */
            font-weight: 500;
            padding: 0 1rem; /* Some padding for smaller screens */
        }

        /* Cart Icon Styling */
        #cart-icon-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background-color: #E44D26; /* Match main accent color */
            color: white;
            border-radius: 50%;
            width: 3.5rem;
            height: 3.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            transition: transform 0.2s ease-in-out, background-color 0.2s ease-in-out;
        }
        #cart-icon-container:hover {
            transform: scale(1.1);
            background-color: #FF6347;
        }
        #cart-count {
            position: absolute;
            top: -0.5rem;
            right: -0.5rem;
            background-color: #FFD700; /* Gold/Yellow for visibility */
            color: #333;
            border-radius: 50%;
            padding: 0.2rem 0.5rem;
            font-size: 0.8rem;
            font-weight: bold;
            display: none; /* Hidden by default */
        }

        /* Cart View Specific Styling */
        #cart-view {
            display: none; /* Hidden by default */
            padding: 2rem;
            max-width: 32rem;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 1.5rem;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            min-height: 50vh; /* Ensure some height for the cart view */
        }
        .cart-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px dashed #eee;
        }
        .cart-item:last-child {
            border-bottom: none;
        }
        .cart-item-info {
            flex-grow: 1;
            margin-right: 1rem;
        }
        .cart-item-name {
            font-weight: 600;
            color: #333;
        }
        .cart-item-details {
            font-size: 0.85rem;
            color: #666;
        }
        .cart-item-quantity {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .cart-quantity-btn {
            background-color: #ddd;
            color: #333;
            border: none;
            border-radius: 0.25rem;
            width: 1.8rem;
            height: 1.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .cart-quantity-btn:hover {
            background-color: #ccc;
        }
        .cart-item-price {
            font-weight: 700;
            color: #E44D26;
            text-align: right;
            min-width: 4rem; /* Ensure price column aligns */
        }
        .cart-total {
            font-size: 1.5rem;
            font-weight: 700;
            color: #CC5500;
            text-align: right;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 2px solid #CD853F;
        }
        .cart-actions {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 2rem;
        }
        .btn-primary {
            background-color: #4CAF50; /* Green for success/action */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            text-align: center;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        .btn-primary:hover {
            background-color: #45a049;
        }
        .btn-secondary {
            background-color: #f44336; /* Red for destructive/cancel */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            text-align: center;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        .btn-secondary:hover {
            background-color: #da190b;
        }
        .empty-cart-message {
            text-align: center;
            color: #777;
            margin-top: 3rem;
            font-size: 1.1rem;
        }
        .address-input-group {
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .address-input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }
        .address-input-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ccc;
            border-radius: 0.5rem;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            resize: vertical; /* Allow vertical resizing */
            min-height: 4rem; /* Minimum height for textarea */
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-3 sm:p-5 md:p-7">

    <!-- Menu View -->
    <div id="menu-view" class="menu-card w-full mx-auto p-6 my-8">
        <!-- Título/Logo do Cardápio -->
        <img src="https://i.ibb.co/9kTCsqsh/Whats-App-Image-2025-06-06-at-14-24-25-removebg-preview.png" alt="Rotella Pizzaria Logo" class="pizzaria-logo">

        <!-- Seção de Combos Promocionais -->
        <div class="mb-8">
            <h2 class="text-3xl sm:text-4xl section-title mb-4 flex items-center justify-center">
                <i class="fas fa-tags mr-3 text-purple-600"></i> Combos Promocionais
            </h2>
            <ul class="grid grid-cols-1 gap-3 text-lg sm:text-xl text-gray-800">
                <li class="bg-purple-50 p-3 rounded-lg shadow-sm flex items-center justify-between cursor-pointer"
                    data-name="Combo: 1 Pizza grande + 1 Coca-Cola 1L" data-price="39.90">
                    <span class="item-name">1 Pizza grande + 1 Coca-Cola 1L</span>
                    <span class="item-price">R$ 39,90</span>
                </li>
                <li class="bg-purple-50 p-3 rounded-lg shadow-sm flex items-center justify-between cursor-pointer"
                    data-name="Combo: 2 Pizzas grandes + 1 Coca-Cola 2L" data-price="75.99">
                    <span class="item-name">2 Pizzas grandes + 1 Coca-Cola 2L</span>
                    <span class="item-price">R$ 75,99</span>
                </li>
            </ul>
            <p class="observation">
                *Pizzas dos combos são válidas apenas para sabores tradicionais.
            </p>
        </div>

        <!-- Seção de Pizzas Grandes -->
        <div class="mb-8">
            <h2 class="text-3xl sm:text-4xl section-title mb-4 flex items-center justify-center">
                <i class="fas fa-pizza-slice mr-3 text-red-600"></i> Pizzas Grandes
            </h2>

            <!-- Subseção de Sabores Tradicionais -->
            <h3 class="text-2xl sm:text-3xl section-title mb-4 flex items-center justify-center">
                Sabores Tradicionais
            </h3>
            <p class="text-center text-xl sm:text-2xl font-semibold text-gray-700 mb-6">
                Preço: <span class="item-price">R$ 34,99 cada</span>
            </p>
            <ul class="grid grid-cols-1 gap-3 text-lg sm:text-xl text-gray-800 mb-6">
                <li class="bg-red-50 rounded-lg shadow-sm cursor-pointer"
                    data-name="Pizza Grande de Calabresa" data-price="34.99"
                    data-ingredients="delicioso molho de tomate caseiro, bastante mussarela, muita calabresa, cebola e orégano.">
                    <div class="pizza-link">
                        <span class="item-name">Calabresa</span>
                        <span class="item-ingredients">delicioso molho de tomate caseiro, bastante mussarela, muita calabresa, cebola e orégano.</span>
                    </div>
                </li>
                <li class="bg-red-50 rounded-lg shadow-sm cursor-pointer"
                    data-name="Pizza Grande de Mussarela" data-price="34.99"
                    data-ingredients="delicioso molho de tomate caseiro, muita mussarela, tomate e orégano.">
                    <div class="pizza-link">
                        <span class="item-name">Mussarela</span>
                        <span class="item-ingredients">delicioso molho de tomate caseiro, muita mussarela, tomate e orégano.</span>
                    </div>
                </li>
                <li class="bg-red-50 rounded-lg shadow-sm cursor-pointer"
                    data-name="Pizza Grande de Portuguesa" data-price="34.99"
                    data-ingredients="delicioso molho de tomate caseiro, mussarela à vontade, presunto de peru, cebola, pimentão, tomate, ovos cozidos, ervilha, azeitona e orégano.">
                    <div class="pizza-link">
                        <span class="item-name">Portuguesa</span>
                        <span class="item-ingredients">delicioso molho de tomate caseiro, mussarela à vontade, presunto de peru, cebola, pimentão, tomate, ovos cozidos, ervilha, azeitona e orégano.</span>
                    </div>
                </li>
                <li class="bg-red-50 rounded-lg shadow-sm cursor-pointer"
                    data-name="Pizza Grande de Marguerita" data-price="34.99"
                    data-ingredients="delicioso molho de tomate caseiro, bastante mussarela, manjericão fresco e orégano.">
                    <div class="pizza-link">
                        <span class="item-name">Marguerita</span>
                        <span class="item-ingredients">delicioso molho de tomate caseiro, bastante mussarela, manjericão fresco e orégano.</span>
                    </div>
                </li>
            </ul>

            <!-- Subseção de Sabores Especiais -->
            <h3 class="text-2xl sm:text-3xl section-title mb-4 flex items-center justify-center">
                Sabores Especiais
            </h3>
            <p class="text-center text-xl sm:text-2xl font-semibold text-gray-700 mb-6">
                Preço: <span class="item-price">R$ 44,99 cada</span>
            </p>
            <ul class="grid grid-cols-1 gap-3 text-lg sm:text-xl text-gray-800">
                <li class="bg-red-50 rounded-lg shadow-sm cursor-pointer"
                    data-name="Pizza Grande Especial de Frango com Catupiry" data-price="44.99"
                    data-ingredients="delicioso molho de tomate caseiro, frango desfiado temperado, catupiry e orégano.">
                    <div class="pizza-link">
                        <span class="item-name">Frango com Catupiry</span>
                        <span class="item-ingredients">delicioso molho de tomate caseiro, frango desfiado temperado, catupiry e orégano.</span>
                    </div>
                </li>
                <li class="bg-red-50 rounded-lg shadow-sm cursor-pointer"
                    data-name="Pizza Grande Especial de Calabresa Supreme" data-price="44.99"
                    data-ingredients="delicioso molho de tomate caseiro, muita calabresa, cebola, catupiry e orégano.">
                    <div class="pizza-link">
                        <span class="item-name">Calabresa Supreme</span>
                        <span class="item-ingredients">delicioso molho de tomate caseiro, muita calabresa, cebola, catupiry e orégano.</span>
                    </div>
                </li>
            </ul>
        </div>

        <!-- Seção de Pizzas Médias -->
        <div class="mb-8">
            <h2 class="text-3xl sm:text-4xl section-title mb-4 flex items-center justify-center">
                <i class="fas fa-pizza-slice mr-3 text-red-600"></i> Pizzas Médias
            </h2>
            <p class="text-center text-xl sm:text-2xl font-semibold text-gray-700 mb-6">
                Preço: <span class="item-price">R$ 29,99 cada</span>
            </p>
            <ul class="grid grid-cols-1 gap-3 text-lg sm:text-xl text-gray-800">
                <li class="bg-red-50 rounded-lg shadow-sm cursor-pointer"
                    data-name="Pizza Média de Chocolate" data-price="29.99"
                    data-ingredients="delicioso chocolate ao leite, creme de avelã e granulado.">
                    <div class="pizza-link">
                        <span class="item-name">Chocolate</span>
                        <span class="item-ingredients">delicioso chocolate ao leite, creme de avelã e granulado.</span>
                    </div>
                </li>
                <li class="bg-red-50 rounded-lg shadow-sm cursor-pointer"
                    data-name="Pizza Média de Romeu e Julieta" data-price="29.99"
                    data-ingredients="creme de queijo, goiabada e toque de canela.">
                    <div class="pizza-link">
                        <span class="item-name">Romeu e Julieta</span>
                        <span class="item-ingredients">creme de queijo, goiabada e toque de canela.</span>
                    </div>
                </li>
            </ul>
        </div>

        <!-- Observação sobre Massa Artesanal -->
        <p class="pizza-dough-observation">
            *Todas as nossas pizzas são feitas com massa artesanal.
        </p>

        <!-- Seção de Refrigerantes -->
        <div class="mb-8">
            <h2 class="text-3xl sm:text-4xl section-title mb-4 flex items-center justify-center">
                <i class="fas fa-wine-bottle mr-3 text-green-600"></i> Refrigerantes
            </h2>
            <ul class="grid grid-cols-1 gap-3 text-lg sm:text-xl text-gray-800">
                <li class="bg-green-50 p-3 rounded-lg shadow-sm flex items-center justify-between cursor-pointer"
                    data-name="Coca-Cola 1L" data-price="8.99">
                    <span class="item-name">Coca-Cola 1L</span>
                    <span class="item-price">R$ 8,99</span>
                </li>
                <li class="bg-green-50 p-3 rounded-lg shadow-sm flex items-center justify-between cursor-pointer"
                    data-name="Coca-Cola 2L" data-price="12.99">
                    <span class="item-name">Coca-Cola 2L</span>
                    <span class="item-price">R$ 12,99</span>
                </li>
                <li class="bg-green-50 p-3 rounded-lg shadow-sm flex items-center justify-between cursor-pointer"
                    data-name="Fanta Laranja 2L" data-price="12.99">
                    <span class="item-name">Fanta Laranja 2L</span>
                    <span class="item-price">R$ 12,99</span>
                </li>
                <li class="bg-green-50 p-3 rounded-lg shadow-sm flex items-center justify-between cursor-pointer"
                    data-name="Guaraná Antárctica 2L" data-price="10.99">
                    <span class="item-name">Guaraná Antárctica 2L</span>
                    <span class="item-price">R$ 10,99</span>
                </li>
            </ul>
        </div>

        <!-- Rodapé com Telefone para Pedidos -->
        <div class="text-center mt-10">
            <div class="footer-phone-container">
                <a href="https://wa.me/559286161640?text=Ol%C3%A1%2C%20gostaria%20de%20fazer%20um%20pedido!" target="_blank" class="footer-phone-link">
                    Pedidos: (92) 9986161640
                </a>
            </div>
            <p class="footer-observation">
                *Funcionamos apenas para delivery de sexta - domingo das 18h às 00h.<br>
                *Consulte taxa de entrega.
            </p>
        </div>
    </div>

    <!-- Cart View -->
    <div id="cart-view" class="menu-card w-full mx-auto p-6 my-8">
        <h2 class="text-3xl sm:text-4xl section-title mb-6 flex items-center justify-center">
            <i class="fas fa-shopping-cart mr-3 text-red-600"></i> Seu Pedido
        </h2>
        <div id="cart-items-container">
            <!-- Cart items will be rendered here by JavaScript -->
        </div>

        <!-- Campo para Endereço de Entrega -->
        <div class="address-input-group">
            <label for="delivery-address">Endereço para Entrega:</label>
            <textarea id="delivery-address" placeholder="Rua, número, bairro, complemento (se houver)" rows="3"></textarea>
        </div>

        <div class="cart-total">
            Total: <span id="cart-total-price">R$ 0,00</span>
        </div>
        <div class="cart-actions">
            <button id="finalize-order-btn" class="btn-primary">Finalizar Pedido via WhatsApp</button>
            <button id="back-to-menu-btn" class="btn-secondary">Voltar ao Cardápio</button>
        </div>
    </div>

    <!-- Floating Cart Icon -->
    <div id="cart-icon-container">
        <i class="fas fa-shopping-cart"></i>
        <span id="cart-count">0</span>
    </div>

    <script>
        // Array para armazenar os itens do carrinho
        let cart = [];

        // Elementos do DOM
        const menuView = document.getElementById('menu-view');
        const cartView = document.getElementById('cart-view');
        const cartIconContainer = document.getElementById('cart-icon-container');
        const cartCountSpan = document.getElementById('cart-count');
        const cartItemsContainer = document.getElementById('cart-items-container');
        const cartTotalPriceSpan = document.getElementById('cart-total-price');
        const finalizeOrderBtn = document.getElementById('finalize-order-btn');
        const backToMenuBtn = document.getElementById('back-to-menu-btn');
        const deliveryAddressInput = document.getElementById('delivery-address'); // Novo elemento de endereço

        // Adiciona event listeners aos itens do menu para adicionar ao carrinho
        document.querySelectorAll('ul li[data-name]').forEach(item => {
            item.addEventListener('click', (event) => {
                const name = item.dataset.name;
                const price = parseFloat(item.dataset.price);
                const ingredients = item.dataset.ingredients || ''; // Pode ser vazio para refrigerantes/combos
                addToCart(name, price, ingredients);
            });
        });

        // Event listener para o ícone do carrinho
        cartIconContainer.addEventListener('click', showCart);

        // Event listeners para os botões da tela do carrinho
        backToMenuBtn.addEventListener('click', hideCart);
        finalizeOrderBtn.addEventListener('click', finalizeOrder);

        /**
         * Adiciona um item ao carrinho ou atualiza sua quantidade.
         * @param {string} name - Nome do item.
         * @param {number} price - Preço individual do item.
         * @param {string} ingredients - Ingredientes do item (opcional).
         */
        function addToCart(name, price, ingredients = '') {
            const existingItemIndex = cart.findIndex(item => item.name === name);

            if (existingItemIndex > -1) {
                cart[existingItemIndex].quantity++;
            } else {
                cart.push({ name, price, ingredients, quantity: 1 });
            }
            updateCartDisplay();
            // Optional: Provide visual feedback like a small animation or message
            showTemporaryMessage(`"${name}" adicionado ao carrinho!`);
        }

        /**
         * Remove um item do carrinho ou diminui sua quantidade.
         * @param {string} name - Nome do item a ser removido.
         */
        function removeFromCart(name) {
            const existingItemIndex = cart.findIndex(item => item.name === name);

            if (existingItemIndex > -1) {
                if (cart[existingItemIndex].quantity > 1) {
                    cart[existingItemIndex].quantity--;
                } else {
                    cart.splice(existingItemIndex, 1); // Remove item se a quantidade for 1
                }
            }
            updateCartDisplay();
            renderCartItems(); // Re-render cart view after removal
        }

        /**
         * Atualiza o contador no ícone do carrinho.
         */
        function updateCartDisplay() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            if (totalItems > 0) {
                cartCountSpan.textContent = totalItems;
                cartCountSpan.style.display = 'flex'; // Show the badge
            } else {
                cartCountSpan.style.display = 'none'; // Hide the badge
            }
        }

        /**
         * Mostra a tela do carrinho e esconde o menu.
         */
        function showCart() {
            menuView.style.display = 'none';
            cartView.style.display = 'block';
            cartIconContainer.style.display = 'none'; // Hide cart icon when cart view is open
            renderCartItems();
        }

        /**
         * Esconde a tela do carrinho e mostra o menu.
         */
        function hideCart() {
            cartView.style.display = 'none';
            menuView.style.display = 'block';
            cartIconContainer.style.display = 'flex'; // Show cart icon again
            updateCartDisplay(); // Ensure count is correct when returning to menu
        }

        /**
         * Renderiza os itens dentro da tela do carrinho.
         */
        function renderCartItems() {
            cartItemsContainer.innerHTML = ''; // Limpa os itens existentes
            let totalPrice = 0;

            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="empty-cart-message">Seu carrinho está vazio.</p>';
                finalizeOrderBtn.disabled = true; // Disable finalize button if cart is empty
            } else {
                finalizeOrderBtn.disabled = false; // Enable finalize button
                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    totalPrice += itemTotal;

                    const itemElement = document.createElement('div');
                    itemElement.className = 'cart-item';
                    itemElement.innerHTML = `
                        <div class="cart-item-info">
                            <span class="cart-item-name">${item.name} (${item.quantity}x)</span>
                            ${item.ingredients ? `<span class="cart-item-details">${item.ingredients}</span>` : ''}
                        </div>
                        <div class="cart-item-quantity">
                            <button class="cart-quantity-btn" data-action="decrease" data-name="${item.name}">-</button>
                            <span>${item.quantity}</span>
                            <button class="cart-quantity-btn" data-action="increase" data-name="${item.name}">+</button>
                        </div>
                        <span class="cart-item-price">R$ ${itemTotal.toFixed(2).replace('.', ',')}</span>
                    `;
                    cartItemsContainer.appendChild(itemElement);
                });
            }

            cartTotalPriceSpan.textContent = `R$ ${totalPrice.toFixed(2).replace('.', ',')}`;

            // Add event listeners for quantity buttons
            document.querySelectorAll('.cart-quantity-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const action = event.target.dataset.action;
                    const name = event.target.dataset.name;
                    if (action === 'increase') {
                        // Pass existing item's price and ingredients to ensure correct re-addition
                        const itemToUpdate = cart.find(i => i.name === name);
                        addToCart(name, itemToUpdate.price, itemToUpdate.ingredients);
                    } else if (action === 'decrease') {
                        removeFromCart(name);
                    }
                });
            });
        }

        /**
         * Gera a mensagem do WhatsApp com os itens do carrinho e o total.
         */
        function finalizeOrder() {
            if (cart.length === 0) {
                showTemporaryMessage('Seu carrinho está vazio! Adicione itens antes de finalizar o pedido.');
                return;
            }

            const deliveryAddress = deliveryAddressInput.value.trim();
            if (!deliveryAddress) {
                showTemporaryMessage('Por favor, preencha o endereço para entrega.');
                deliveryAddressInput.focus();
                return;
            }

            let message = "Olá Rotella Pizzaria! Gostaria de fazer o seguinte pedido:\n\n";
            let total = 0;

            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                message += `${item.quantity}x ${item.name}`;
                if (item.ingredients) {
                    message += ` (${item.ingredients.replace(/\.$/, '')})`; // Remove dot if exists
                }
                message += ` - R$ ${itemTotal.toFixed(2).replace('.', ',')}\n`;
                total += itemTotal;
            });

            message += `\nTotal: R$ ${total.toFixed(2).replace('.', ',')}`;
            message += `\n\nEndereço para entrega: ${deliveryAddress}`;
            message += "\nForma de pagamento: [FORMA DE PAGAMENTO]"; // Placeholder for user to fill

            const whatsappUrl = `https://wa.me/559286161640?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');

            // Optional: Clear cart after finalizing order
            cart = [];
            deliveryAddressInput.value = ''; // Clear address field
            updateCartDisplay();
            hideCart(); // Go back to menu
            showTemporaryMessage('Pedido enviado! Aguarde a confirmação da Rotella Pizzaria.');
        }

        /**
         * Exibe uma mensagem temporária ao usuário (substitui alert/confirm).
         * @param {string} msg - A mensagem a ser exibida.
         * @param {number} duration - Duração em milissegundos (padrão: 3000).
         */
        function showTemporaryMessage(msg, duration = 3000) {
            let messageBox = document.getElementById('custom-message-box');
            if (!messageBox) {
                messageBox = document.createElement('div');
                messageBox.id = 'custom-message-box';
                messageBox.style.cssText = `
                    position: fixed;
                    bottom: 7rem; /* Above the cart icon */
                    left: 50%;
                    transform: translateX(-50%);
                    background-color: #333;
                    color: white;
                    padding: 0.75rem 1.5rem;
                    border-radius: 0.5rem;
                    z-index: 1001;
                    opacity: 0;
                    transition: opacity 0.3s ease-in-out;
                    font-size: 0.9rem;
                    text-align: center;
                    pointer-events: none; /* Allows clicks to pass through */
                `;
                document.body.appendChild(messageBox);
            }
            messageBox.textContent = msg;
            messageBox.style.opacity = '1';

            setTimeout(() => {
                messageBox.style.opacity = '0';
            }, duration);
        }

        // Inicializa a exibição do carrinho ao carregar a página
        document.addEventListener('DOMContentLoaded', updateCartDisplay);
    </script>
</body>
</html>
